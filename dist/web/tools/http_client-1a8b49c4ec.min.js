var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n])}return e},ajaxArr={};function httpLog(e,t,o,n){switch(e){case"req":"string"==typeof t&&console.log("请求参数:_____",JSON.parse(t));break;case"success":console.warn(t,o);break;case"err":console.error("_errorData:_____",t,o,n)}}function filterUrl(e,t,o){return t.ip?t.ip+e:"string"==typeof e&&"img"===e?o+"/upload":t.coupon?COUPON_ENV+e:o+e}function getPF(){var e=window.sessionStorage.getItem("PF");if(null!==e)return e;var t=navigator.userAgent,o=/Android/i.test(t),n=/(iPhone|iPad|iPod|iOS|MAC)/i.test(t),r=/windows/gi.test(t);return e=o?"Android":n?"ios":r?"windows":t,window.sessionStorage.setItem("PF",e),e}function getIp(){var t="NULL";try{t=returnCitySN.cip}catch(e){t="NULL"}return t}function getUA(){window.addEventListener("resize",function(e){return window.sessionStorage.removeItem("PF")});var e=getDeviceInfo();return getBrowserInfo()+"|"+e+"|NO_DEVICE_ID|"+getIp()}function getDeviceInfo(){var t="NULL",e=getPF(),o=navigator.userAgent;if("Android"==e)try{t=o.match(/(Android.*)\sbuild/i)[1].replace(/(\;\s)/g,"|")}catch(e){t=o}else if("ios"==e){var n=screen.height,r=screen.width;t=812==n&&375==r?"iPhoneX":736==n&&414==r?"iPhone6P/iPhone7P/iPhone8P":667==n&&375==r?"iPhone6/iPhone7/iPhone8":568==n&&320==r?"iPhone5":"iPhone4"}else if("windows"==e){t=o.match(/(window.*?);{1}/i)[1]}return t}function getBrowserInfo(){var e=window.navigator.userAgent,t=null;switch(!0){case/dingtalk/i.test(e):t="dingding";break;case/UC/i.test(e):t="ucBrowser";break;case/baidu/i.test(e):t="baiduBrowser";break;case/baiduboxapp/i.test(e):t="baiduApp";break;case/micromessenger/i.test(e):t="wx";break;case/MQQBrowser/i.test(e):t="QQBrowser";break;case/miuiBrowser/i.test(e):t="xiaomiBrowser";break;case/vivoBrowser/i.test(e):t="vivoBrowser";break;case/oppoBrowser/i.test(e):t="oppoBrowser";break;case/MZBrowser/i.test(e):t="meizuBrowser";break;case/huawei/i.test(e):t="huaweiBrowser";break;case/Chrome/i.test(e):t="Chrome";break;case/Safari/i.test(e):t="Safari";break;default:t=e}return t}function getPostRequest(e,t){var o={client:{caller:"website",channel:"web",deviceId:null,dpi:window.screen.width+" × "+window.screen.height,ex:{},macIp:getIp(),unitType:getDeviceInfo(),pf:getPF(),ua:getUA(),sysVersion:"NULL",vCode:0,vName:"1.3.0"},data:_extends({},e),encrypt:"web",requestId:"website-"+ +new Date,sign:"web"},n=getHttpCurrentPosition(),r=n.latitude,i=n.longitude;return o.data.token=getToken(),o.latitude=r,o.longitude=i,JSON.stringify(o)}function uploadImgParams(e,t){var o=new FormData,n="default"===t.token?"VE9LRU4tMTEtMTU0MjE2MTk1ODEyNi0xMS1hYmM_":getToken();return o.append("files",e.files),o.append("token",n),o}function getToken(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return e.token&&""!==e.token?e.token:""===e.token?"":utils.getUserToken()}function getHttpCurrentPosition(){var e={latitude:0,longitude:0},t=window.localStorage.getItem("GET_CURRENT_LOCATION");if(!t)return e;var o=JSON.parse(t),n=o.latitude,r=o.longitude;return e.latitude=n,e.longitude=r,e}function formatReq(e,t,o){return"GET"===t.type?{}:"object"===(void 0===e?"undefined":_typeof(e))?"img"===o?uploadImgParams(e,t):getPostRequest(e,t):{}}function isInvalidToken(e){var t=!0;switch(e){case 100001:t=!0;break;default:t=!1}return t}function invalidTokenToReLogin(e){var t=utils.urlToObj(),o=t.activeId,n=t.ua,r=t.native;r||o||"web"!=n?alsj.reLogin():"web"!=n&&r&&o||utils.goLogin()}Vue.prototype.$http=function(o,e,t,n){var r=4<arguments.length&&void 0!==arguments[4]?arguments[4]:{};if(r.noRepeat&&ajaxArr[o])return console.error("已拦截重复操作"),!1;ajaxArr[o]=!0;var i=filterUrl(o,r,API_ENV),a=formatReq(e,r,o),s={data:a,type:r.type||"POST",dataType:"json",contentType:"img"!==o&&"application/json; charset=utf-8",processData:"GET"==r.type,cache:!1,async:!0,timeout:1e4,beforeSend:function(e){r.autoLoading&&loadingDom&&loadingDom.showLoading()},complete:function(e){var t=e.responseJSON;r.noRepeat&&(ajaxArr[o]=!1),r.log&&httpLog("req",a),r.complete?r.complete(t):"function"==typeof r&&r(t),r.autoLoading&&loadingDom&&loadingDom.hideLoading()},success:function(e){if(r.log&&httpLog("success",o,e),"img"===o&&t)return t(e);if(200==e.code)t&&t(e);else{if(isInvalidToken(e.code))return e.noLogin=!0,vm.$toast("登录超时，请重新登录",function(){utils.clearUserInfo(),invalidTokenToReLogin(e)});n&&"function"==typeof n?n(e):vm.$toast(e.msg)}},error:function(e,t,o){console.log("XMLHttpRequest",e,t,o);switch(!0){case"timeout"==t:vm.$toast("网络连接超时");break;case 500==e.status:vm.$toast("系统繁忙");break;default:vm.$toast("网络异常，请检查网络设置")}}};$.ajax(i,s)},Vue.prototype.$http2=function(e,t,o,n){var r=4<arguments.length&&void 0!==arguments[4]?arguments[4]:{};r.autoLoading="no"!==r.autoLoading,Vue.prototype.$http(e,t,o,n,r)};